<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE COLOSSEUM - ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ø´ÙØ±Ø§Øª</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Georgia', serif; background: linear-gradient(135deg, #0a0e27, #1a1a3e); color: #fff; }
        .header { text-align: center; padding: 20px; border-bottom: 3px solid #d4af37; }
        .header h1 { font-size: 2.5em; background: linear-gradient(135deg, #d4af37, #ffd700); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; letter-spacing: 3px; }
        .timer-bar { background: rgba(212, 175, 55, 0.2); border: 2px solid #d4af37; padding: 15px; text-align: center; font-size: 1.5em; color: #d4af37; font-weight: bold; display: none; margin-top: 15px; }
        .timer-bar.active { display: block; }
        .timer-bar.warning { color: #ff6b6b; border-color: #ff6b6b; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .screen { display: none; }
        .screen.active { display: block; }
        .login-container { display: flex; justify-content: center; align-items: center; min-height: 60vh; }
        .login-box { background: rgba(212, 175, 55, 0.1); border: 3px solid #d4af37; padding: 50px; border-radius: 10px; width: 100%; max-width: 500px; text-align: center; }
        .login-box h2 { color: #d4af37; margin-bottom: 30px; font-size: 2em; letter-spacing: 2px; }
        .login-box input { width: 100%; padding: 15px; margin-bottom: 20px; border: 2px solid #d4af37; border-radius: 5px; font-size: 1.1em; background: rgba(255, 255, 255, 0.05); color: #fff; text-align: center; }
        .login-box button { width: 100%; padding: 15px; background: linear-gradient(135deg, #d4af37, #ffd700); color: #000; border: none; border-radius: 5px; font-size: 1.2em; font-weight: bold; cursor: pointer; }
        .login-box button:hover { transform: scale(1.05); box-shadow: 0 0 20px rgba(212, 175, 55, 0.8); }
        .teams-title { text-align: center; font-size: 2.5em; color: #d4af37; margin-bottom: 30px; letter-spacing: 2px; }
        .teams-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .team-card { background: rgba(212, 175, 55, 0.1); border: 2px solid #d4af37; padding: 25px; border-radius: 10px; cursor: pointer; transition: all 0.3s; text-align: center; }
        .team-card:hover:not(.disabled) { transform: translateY(-5px); box-shadow: 0 10px 30px rgba(212, 175, 55, 0.5); border-color: #ffd700; }
        .team-card.selected { background: rgba(212, 175, 55, 0.3); border-color: #ffd700; box-shadow: 0 0 30px rgba(212, 175, 55, 0.8); }
        .team-card.disabled { opacity: 0.4; cursor: not-allowed; background: rgba(100, 100, 100, 0.1); border-color: #666; }
        .team-card h3 { color: #d4af37; margin-bottom: 15px; font-size: 1.5em; }
        .team-status { margin: 15px 0; font-size: 0.95em; line-height: 1.6; }
        .team-actions { margin-top: 15px; }
        .team-btn { background: #d4af37; color: #000; border: none; padding: 10px; border-radius: 5px; cursor: pointer; font-weight: bold; width: 100%; margin-top: 8px; transition: all 0.3s; }
        .team-btn:hover { background: #ffd700; transform: scale(1.05); }
        .reserved-badge { color: #ff6b6b; font-weight: bold; margin-top: 10px; }
        .available-badge { color: #4CAF50; font-weight: bold; margin-top: 10px; }
        .start-btn { width: 100%; padding: 20px; background: linear-gradient(135deg, #d4af37, #ffd700); color: #000; border: none; border-radius: 5px; font-size: 1.3em; font-weight: bold; cursor: pointer; margin-top: 30px; display: none; }
        .start-btn.show { display: block; }
        .start-btn:hover { transform: scale(1.05); box-shadow: 0 0 30px rgba(212, 175, 55, 0.8); }
        .code-container { background: rgba(0, 0, 0, 0.85); border: 3px solid #d4af37; padding: 50px; border-radius: 10px; max-width: 600px; margin: 30px auto; text-align: center; box-shadow: 0 0 50px rgba(212, 175, 55, 0.5); }
        .code-container h2 { color: #d4af37; font-size: 2em; margin-bottom: 20px; letter-spacing: 2px; }
        .team-info { font-size: 1.1em; color: #ffd700; margin-bottom: 20px; }
        .code-input { width: 100%; padding: 15px; border: 2px solid #d4af37; border-radius: 5px; font-size: 1.2em; background: rgba(255, 255, 255, 0.05); color: #d4af37; text-align: center; text-transform: uppercase; letter-spacing: 2px; margin: 20px 0; }
        .code-btn { width: 100%; padding: 15px; background: linear-gradient(135deg, #d4af37, #ffd700); color: #000; border: none; border-radius: 5px; font-size: 1.2em; font-weight: bold; cursor: pointer; }
        .code-btn:hover { transform: scale(1.05); box-shadow: 0 0 20px rgba(212, 175, 55, 0.8); }
        .message { margin-top: 20px; font-size: 1.1em; font-weight: bold; min-height: 30px; line-height: 1.5; }
        .message.success { color: #4CAF50; }
        .message.error { color: #ff6b6b; }
        .images-screen { background: linear-gradient(135deg, #2a2520, #3d3935); min-height: 100vh; padding-top: 20px; }
        .images-container { background: rgba(0, 0, 0, 0.8); border: 3px solid #d4af37; padding: 40px; border-radius: 10px; max-width: 1000px; margin: 20px auto; box-shadow: 0 0 50px rgba(212, 175, 55, 0.5); }
        .images-title { color: #d4af37; font-size: 2em; text-align: center; margin-bottom: 30px; letter-spacing: 2px; }
        .images-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .image-box { width: 100%; height: 200px; background: rgba(212, 175, 55, 0.1); border: 2px solid #d4af37; border-radius: 8px; overflow: hidden; cursor: pointer; transition: all 0.3s; position: relative; }
        .image-box:hover { transform: scale(1.05); box-shadow: 0 5px 15px rgba(212, 175, 55, 0.5); }
        .image-box img { width: 100%; height: 100%; object-fit: cover; }
        .image-label { position: absolute; top: 10px; right: 10px; background: rgba(212, 175, 55, 0.9); color: #000; padding: 5px 10px; border-radius: 5px; font-size: 0.8em; font-weight: bold; }
        .button-group { text-align: center; margin-top: 30px; }
        .download-btn, .back-btn { padding: 12px 25px; font-size: 1em; border: none; border-radius: 5px; cursor: pointer; margin: 10px; font-weight: bold; transition: all 0.3s; }
        .download-btn { background: linear-gradient(135deg, #4CAF50, #45a049); color: white; }
        .download-btn:hover { transform: scale(1.05); box-shadow: 0 0 20px rgba(76, 175, 80, 0.6); }
        .back-btn { background: #d4af37; color: #000; }
        .back-btn:hover { background: #ffd700; transform: scale(1.05); }
        .admin-container { background: rgba(212, 175, 55, 0.1); border: 3px solid #d4af37; padding: 40px; border-radius: 10px; max-width: 600px; margin: 50px auto; text-align: center; }
        .admin-container h2 { color: #d4af37; margin-bottom: 30px; font-size: 2em; }
        .admin-btn { width: 100%; padding: 15px; background: #d4af37; color: #000; border: none; border-radius: 5px; font-size: 1.1em; cursor: pointer; margin: 10px 0; font-weight: bold; transition: all 0.3s; }
        .admin-btn:hover { background: #ffd700; transform: scale(1.05); }
        .admin-btn.danger { background: #ff6b6b; color: white; }
        .admin-btn.danger:hover { background: #ff5252; }
        .stats-table { width: 100%; color: #d4af37; margin-top: 20px; border-collapse: collapse; }
        .stats-table th, .stats-table td { border: 1px solid #d4af37; padding: 12px; text-align: center; }
        .stats-table th { background: rgba(212, 175, 55, 0.2); }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ” THE COLOSSEUM</h1>
        <div class="timer-bar" id="timerBar">
            â±ï¸ <span id="timerDisplay">02:00:00</span>
        </div>
    </div>

    <div class="container">
        <div class="screen active" id="loginScreen">
            <div class="login-container">
                <div class="login-box">
                    <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
                    <input type="text" id="userNameInput" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„" onkeypress="if(event.key==='Enter') goToTeams()">
                    <button onclick="goToTeams()">Ø¯Ø®ÙˆÙ„</button>
                </div>
            </div>
        </div>

        <div class="screen" id="teamsScreen">
            <h2 class="teams-title">ğŸ‘¥ Ø§Ø®ØªØ± ÙØ±ÙŠÙ‚Ùƒ</h2>
            <div class="teams-grid" id="teamsGrid"></div>
            <button class="start-btn" id="startBtn" onclick="startGame()">â–¶ï¸ Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ù‚ÙŠÙ‚</button>
        </div>

        <div class="screen" id="codeScreen">
            <div class="code-container">
                <h2>ğŸ” Ø­Ù„ Ø§Ù„Ø´ÙØ±Ø©</h2>
                <div class="team-info" id="teamInfoCode"></div>
                <input type="text" id="codeInput" class="code-input" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø´ÙØ±Ø©" onkeypress="if(event.key==='Enter') verifyCode()">
                <button class="code-btn" onclick="verifyCode()">âœ“ ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø´ÙØ±Ø©</button>
                <div class="message" id="codeMessage"></div>
            </div>
        </div>

        <div class="screen images-screen" id="imagesScreen">
            <div class="images-container">
                <h2 class="images-title">ğŸ“‹ Ù…Ù„ÙØ§Øª Ø§Ù„Ù‚Ø¶ÙŠØ©</h2>
                <div class="images-grid" id="imagesGrid"></div>
                <div class="button-group">
                    <button class="download-btn" onclick="downloadAllImages()">ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±</button>
                    <button class="back-btn" onclick="backToTeams()">Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
                </div>
            </div>
        </div>

        <div class="screen" id="adminScreen">
            <div class="admin-container">
                <h2>ğŸ”‘ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</h2>
                <button class="admin-btn" onclick="showStats()">ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
                <button class="admin-btn danger" onclick="resetGame()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
                <button class="admin-btn" onclick="backToLogin()">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
            </div>
            <div id="statsContainer"></div>
        </div>
    </div>

    <script>
        const ADMIN_CODE = 'ADMIN2024';
        const CODES = ['POWER', 'WISDOM', 'VALOR', 'PATIENCE', 'PROMPTITUDE', 'FAITH', 'HONESTY', 'JUSTICE', 'INTEGRITY', 'LOYALTY', 'CONFIDENCE'];
        const TOTAL_TIME = 7200;

        const teams = Array(11).fill(0).map((_, i) => ({
            id: i + 1,
            number: i + 1,
            members: [],
            leader: null,
            codeIndex: i,
            solved: false,
            attempts: 0,
            solveTime: null
        }));

        let currentUser = null;
        let currentTeam = null;
        let gameStarted = false;
        let timeRemaining = TOTAL_TIME;
        let timerInterval = null;
        let gameStartTime = null;

        function loadGameState() {
            const saved = localStorage.getItem('colosseum_game_state');
            if (saved) {
                const state = JSON.parse(saved);
                teams.forEach(t => {
                    const savedTeam = state.teams.find(st => st.id === t.id);
                    if (savedTeam) {
                        t.members = savedTeam.members;
                        t.leader = savedTeam.leader;
                        t.solved = savedTeam.solved;
                        t.attempts = savedTeam.attempts;
                    }
                });
                if (state.gameStarted) {
                    gameStarted = true;
                    gameStartTime = new Date(state.gameStartTime);
                    const elapsed = Math.floor((Date.now() - gameStartTime) / 1000);
                    timeRemaining = Math.max(0, TOTAL_TIME - elapsed);
                    if (timeRemaining > 0) startTimer();
                }
            }
        }

        function saveGameState() {
            const state = {
                teams: teams.map(t => ({id: t.id, members: t.members, leader: t.leader, solved: t.solved, attempts: t.attempts})),
                gameStarted: gameStarted,
                gameStartTime: gameStartTime?.toISOString() || null,
                timeRemaining: timeRemaining
            };
            localStorage.setItem('colosseum_game_state', JSON.stringify(state));
        }

        function goToTeams() {
            const userName = document.getElementById('userNameInput').value.trim();
            if (!userName) { alert('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ'); return; }
            if (userName === ADMIN_CODE) { showScreen('adminScreen'); return; }
            currentUser = userName;
            showScreen('teamsScreen');
            renderTeams();
        }

        function renderTeams() {
            const grid = document.getElementById('teamsGrid');
            grid.innerHTML = '';
            teams.forEach(team => {
                const isSelected = currentTeam && currentTeam.id === team.id;
                const isDisabled = team.members.length > 0 && !team.members.includes(currentUser);
                const card = document.createElement('div');
                card.className = `team-card ${isSelected ? 'selected' : ''} ${isDisabled ? 'disabled' : ''}`;
                let statusHTML = '';
                if (team.members.length > 0) {
                    statusHTML = `<p style="color: #ffd700;">ğŸ‘¥ ${team.members.join(', ')}</p>`;
                    statusHTML += `<p class="reserved-badge">ğŸ”’ Ù…Ø­Ø¬ÙˆØ²</p>`;
                } else {
                    statusHTML = `<p class="available-badge">âœ… Ù…ØªØ§Ø­</p>`;
                }
                if (team.leader) statusHTML += `<p style="color: #d4af37; margin-top: 8px;">â­ Ø§Ù„Ù‚Ø§Ø¦Ø¯: ${team.leader}</p>`;
                card.innerHTML = `<h3>Ø§Ù„ÙØ±ÙŠÙ‚ ${team.number}</h3><div class="team-status"><p>Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡: ${team.members.length}/4</p>${statusHTML}</div><div class="team-actions">${!isDisabled && !team.members.includes(currentUser) ? `<button class="team-btn" onclick="selectTeam(${team.id})">Ø§Ø®ØªØ± Ø§Ù„ÙØ±ÙŠÙ‚</button>` : ''}${team.members.includes(currentUser) ? `<button class="team-btn" onclick="leaveTeam(${team.id})">ØºØ§Ø¯Ø± Ø§Ù„ÙØ±ÙŠÙ‚</button>` : ''}</div>`;
                if (!isDisabled) card.onclick = () => selectTeam(team.id);
                grid.appendChild(card);
            });
        }

        function selectTeam(teamId) {
            const team = teams.find(t => t.id === teamId);
            if (team.members.length >= 4 && !team.members.includes(currentUser)) { alert('âŒ Ø§Ù„ÙØ±ÙŠÙ‚ Ù…Ù…ØªÙ„Ø¦!'); return; }
            if (!team.members.includes(currentUser)) {
                team.members.push(currentUser);
                if (!team.leader) team.leader = currentUser;
                saveGameState();
            }
            currentTeam = team;
            document.getElementById('startBtn').classList.add('show');
            renderTeams();
        }

        function leaveTeam(teamId) {
            const team = teams.find(t => t.id === teamId);
            team.members = team.members.filter(m => m !== currentUser);
            if (team.leader === currentUser && team.members.length > 0) {
                team.leader = team.members[0];
            } else if (team.members.length === 0) {
                team.leader = null;
            }
            if (currentTeam && currentTeam.id === teamId) {
                currentTeam = null;
                document.getElementById('startBtn').classList.remove('show');
            }
            saveGameState();
            renderTeams();
        }

        function startGame() {
            if (!currentTeam || currentTeam.members.length === 0) { alert('âš ï¸ Ø§Ø®ØªØ± ÙØ±ÙŠÙ‚Ø§Ù‹'); return; }
            if (!gameStarted) {
                gameStarted = true;
                gameStartTime = new Date();
                document.getElementById('timerBar').classList.add('active');
                startTimer();
                saveGameState();
            }
            document.getElementById('teamInfoCode').textContent = `ğŸ¯ Ø§Ù„ÙØ±ÙŠÙ‚: ${currentTeam.number} | ${currentTeam.members.join(', ')}`;
            showScreen('codeScreen');
            document.getElementById('codeInput').focus();
        }

        function startTimer() {
            if (timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                if (timeRemaining === 300) {
                    document.getElementById('timerBar').classList.add('warning');
                    alert('âš ï¸ ØªØ­Ø°ÙŠØ±: 5 Ø¯Ù‚Ø§Ø¦Ù‚ ÙÙ‚Ø· Ù…ØªØ¨Ù‚ÙŠØ©!');
                }
                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    timeRemaining = 0;
                    updateTimerDisplay();
                    alert('â±ï¸ Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª!');
                    endGame();
                }
                saveGameState();
            }, 1000);
        }

        function updateTimerDisplay() {
            const hours = Math.floor(timeRemaining / 3600);
            const minutes = Math.floor((timeRemaining % 3600) / 60);
            const seconds = timeRemaining % 60;
            const timeStr = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            document.getElementById('timerDisplay').textContent = timeStr;
        }

        function verifyCode() {
            const input = document.getElementById('codeInput').value.trim().toUpperCase();
            const correctCode = CODES[currentTeam.codeIndex];
            const msg = document.getElementById('codeMessage');
            if (input === correctCode) {
                msg.textContent = 'âœ… ØµØ­ÙŠØ­! ØªÙ… ÙØªØ­ Ø§Ù„Ù…Ù„ÙØ§Øª';
                msg.className = 'message success';
                currentTeam.solved = true;
                currentTeam.solveTime = new Date();
                saveGameState();
                setTimeout(() => showImages(), 1500);
            } else {
                currentTeam.attempts++;
                timeRemaining = Math.max(0, timeRemaining - 900);
                msg.innerHTML = `âŒ Ø®Ø·Ø£! -15 Ø¯Ù‚ÙŠÙ‚Ø© Ù…Ù† Ø§Ù„Ø¬Ù…ÙŠØ¹<br>Ù…Ø­Ø§ÙˆÙ„Ø§Øª: ${currentTeam.attempts}`;
                msg.className = 'message error';
                updateTimerDisplay();
                document.getElementById('codeInput').value = '';
                document.getElementById('codeInput').focus();
                saveGameState();
            }
        }

        function showImages() {
            const grid = document.getElementById('imagesGrid');
            grid.innerHTML = '';
            for (let i = 1; i <= 8; i++) {
                const imageBox = document.createElement('div');
                imageBox.className = 'image-box';
                imageBox.innerHTML = `<img src="https://via.placeholder.com/300x400?text=Case+${currentTeam.number}+Image+${i}" alt="ØµÙˆØ±Ø© ${i}"><div class="image-label">ØµÙˆØ±Ø© ${i}</div>`;
                grid.appendChild(imageBox);
            }
            showScreen('imagesScreen');
        }

        function downloadAllImages() { alert('ğŸ“¥ Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ± Ù‚Ø±ÙŠØ¨Ø§Ù‹'); }
        function backToTeams() { document.getElementById('codeInput').value = ''; document.getElementById('codeMessage').textContent = ''; showScreen('teamsScreen'); }
        function endGame() { if (timerInterval) clearInterval(timerInterval); gameStarted = false; document.getElementById('timerBar').classList.remove('warning'); backToTeams(); }

        function showStats() {
            let html = '<h3 style="color: #d4af37; margin-top: 30px;">ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª:</h3>';
            html += '<table class="stats-table"><tr><th>Ø§Ù„ÙØ±ÙŠÙ‚</th><th>Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª</th></tr>';
            teams.forEach(t => {
                const status = t.solved ? 'âœ… Ù…ÙƒØªÙ…Ù„' : 'âŒ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©';
                html += `<tr><td>Ø§Ù„ÙØ±ÙŠÙ‚ ${t.number}</td><td>${t.members.length}/4</td><td>${status}</td><td>${t.attempts}</td></tr>`;
            });
            html += '</table>';
            document.getElementById('statsContainer').innerHTML = html;
        }

        function resetGame() {
            if (confirm('âš ï¸ Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù„Ø¹Ø¨Ø©ØŸ\nØ³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª!')) {
                localStorage.clear();
                teams.forEach(t => { t.members = []; t.leader = null; t.solved = false; t.attempts = 0; });
                gameStarted = false; timeRemaining = TOTAL_TIME; currentUser = null; currentTeam = null;
                if (timerInterval) clearInterval(timerInterval);
                document.getElementById('timerBar').classList.remove('active', 'warning');
                alert('âœ… ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù„Ø¹Ø¨Ø©');
                backToLogin();
            }
        }

        function backToLogin() { currentUser = null; currentTeam = null; document.getElementById('userNameInput').value = ''; showScreen('loginScreen'); }
        function showScreen(screenId) { document.querySelectorAll('.screen').forEach(screen => screen.classList.remove('active')); document.getElementById(screenId).classList.add('active'); }

        window.addEventListener('beforeunload', (e) => { if (gameStarted && currentTeam && !currentTeam.solved) { e.preventDefault(); e.returnValue = ''; } });
        document.addEventListener('DOMContentLoaded', () => { loadGameState(); if (gameStarted) { document.getElementById('timerBar').classList.add('active'); updateTimerDisplay(); } });
    </script>
</body>
</html>
